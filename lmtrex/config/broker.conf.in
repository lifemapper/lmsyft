<VirtualHost *:80>
    ServerName @FQDN@
    # Redirect HTTP traffic to HTTPS
    Redirect permanent /api/ https://@FQDN@/api/
</VirtualHost>

<VirtualHost *:443>
    ServerName @FQDN@
    SSLEngine on
    SSLCertificateFile @CERTFILE@
    SSLCertificateKeyFile @CERTKEYFILE@
    Include @SSL_OPTIONS_FILE@
    SSLCertificateChainFile @CHAIN_FILE@

    WSGIDaemonProcess lmtrex threads=5
    WSGIScriptAlias /api/v1 /var/www/lmtrex/broker.wsgi

    # Custom logs
    LogLevel debug
    CustomLog @LMSCRATCHDISK@/log/apache/lmrex_access combined
    ErrorLog  @LMSCRATCHDISK@/log/apache/lmrex_error

    <Directory /var/www/lmtrex>
        WSGIProcessGroup lmtrex
        WSGIApplicationGroup %{GLOBAL}
        Order allow,deny
        Allow from all
    </Directory>
    
    Alias /js  "@LMHOME@/lmtrex/services/public/js/"
    <Directory "@LMHOME@/lmtrex/services/public/js">
        Options FollowSymLinks Indexes
        AllowOverride None
        Require all granted
        Order allow,deny
    </Directory>

    Alias /css "@LMHOME@/lmtrex/services/public/css/"
    <Directory "@LMHOME@/lmtrex/services/public/css">
        Options FollowSymLinks Indexes
        AllowOverride None
        Require all granted
        Order allow,deny
    </Directory>


</VirtualHost>
