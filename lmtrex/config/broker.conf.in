<VirtualHost *:80>
    ServerName @FQDN@
    # Redirect HTTP traffic to HTTPS
    Redirect permanent /api/ https://@FQDN@/api/
</VirtualHost>

<VirtualHost *:443>
    ServerName @FQDN@
    SSLEngine on
    SSLCertificateFile @CERTFILE@
    SSLCertificateKeyFile @CERTKEYFILE@
    Include @SSL_OPTIONS_FILE@
    SSLCertificateChainFile @CHAIN_FILE@

    WSGIDaemonProcess lmtrex threads=5
    WSGIScriptAlias /api/v1 /var/www/lmtrex/broker.wsgi

    # Custom logs
    LogLevel debug
    CustomLog @LMSCRATCHDISK@/log/apache/lmrex_access combined
    ErrorLog  @LMSCRATCHDISK@/log/apache/lmrex_error

    <Directory /var/www/lmtrex>
        WSGIProcessGroup lmtrex
        WSGIApplicationGroup %{GLOBAL}
        Order deny,allow
        Allow from all
    </Directory>

</VirtualHost>
